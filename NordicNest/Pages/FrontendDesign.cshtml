@page
@model NordicNest.Pages.FrontendDesignModel
@using System.Text.Json;
@using NordicNest.Model.SavingLoanDatabase;
@using NordicNest.Controller.DefaultSLController;
@{
	Layout = null;
	List<NordicNest.Model.Transaction.TransactionVariable> TV = new NordicNest.Model.Transaction.TransactionConnection().GetTransactionInfo();
	List<NordicNest.Model.Subscriptions.SubVariables> SV = new NordicNest.Model.Subscriptions.SubConnection().GetSubscriptionInfo();
	NordicNest.Controller.ClientDataController CDC = new NordicNest.Controller.ClientDataController();
	List<Model.NavBar.NavBarProperties> NBP = new Model.NavBar.NavBarConnection().GetNavBars();
	decimal[] progressBars = { Model.Savingpercentage(), Model.Loanpercentage() };
	NordicNest.Model.BasicProperties.CurrentPage = "Home";
	var Sresult = new DefaultSavingController().GetData();
	var Lresult = new DefaultLoanController().GetData();
	var ClientData = CDC.GetClientData();

	List<string> CSLabel = new List<string> { "Housing", "Transportation", "Living Expenses", "Debt and Savings", "Discretionary Spending" };
	List<int> CSdata = new List<int> { 20, 20, 20, 20, 80 };
	List<string> CSbackgroundColor = new List<string> { "#3498db", "#27ae60", "#e74c3c", "#f39c12", "#8e44ad" };
}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="~/css/styles.css" asp-append-version="true" />
<script src="https://kit.fontawesome.com/f3d48ce569.js" crossorigin="anonymous"></script>
<link href="/css/transparentScrollbar.css" rel="stylesheet" asp-append-version="true" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.all.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<body class="bg-gradient-to-b from-blue-950 to-teal-700 min-h-screen min-w-screen flex justify-center items-center">
	<div class="grid grid-cols-4 lg:grid-cols-5 gap-3 p-4 min-h-screen min-w-screen text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl">
		<!--Profile-->
		<div class="order-1 flex justify-center items-center bg-gradient-to-r from-blue-400 via-indigo-400 to-teal-400 text-white lg:block text-center lg:pt-52 rounded-2xl col-span-2 lg:col-span-1 row-span-2 relative px-4">
			<div class="flex justify-center hidden lg:flex">
				<i class="absolute text-[#3b82f6] fas fa-user hidden top-2 lg:block lg:text-[5rem] xl:text-[7rem] 2xl:text-[10rem]"></i>
			</div>
			<a asp-page=""
			   class="absolute top-2 left-2 fa-solid fa-pen-to-square text-xs sm:text-sm md:text-md lg:text-lg xl:text-xl 2xl:text-2xl text-[#636363]"></a>
			<a asp-page="/ClientCommunication"
			   class="absolute top-2 right-2 fa-solid fa-envelope text-xs sm:text-sm md:text-md lg:text-lg xl:text-xl 2xl:text-2xl text-[#636363]"></a>
			<button class="absolute cursor-pointer bottom-2 right-2 text-red-500 text-xs sm:text-sm md:text-md lg:text-lg xl:text-xl 2xl:text-2xl z-50 hover:text-black hover:scale-110 duration-500">
				<i class="fas fa-sign-out"> </i>
			</button>
			Welcome to your dashboard @ClientData.Item1
		</div>

		<!--Current Amount-->
		<div class="order-4 lg:order-2 text-center rounded-2xl col-span-2 lg:col-span-1 bg-[#4CAF50] text-white relative font-extrabold">
			<button onclick="showInfo('CurrentAmount')" 
					class="z-10 absolute fas fa-info-circle top-2 right-2"></button>
			<div class="lg:absolute w-full hidden lg:flex justify-center top-1">
				Current Amount
			</div>
			<div class="flex justify-center items-center h-full lg:text-[1rem] xl:text-[3rem] 2xl:text-[5rem] py-5 lg:pb-6 lg:pt-12">
				@ClientData.Item2
			</div>
		</div>

		<!--Usable Amount-->
		<div class="order-5 lg:order-3 text-center rounded-2xl col-span-4 lg:col-span-1 bg-[#FFC107] text-white relative font-extrabold">
			<button onclick="showInfo('UsableAmount')"
					class="z-10 absolute fas fa-info-circle top-2 right-2"></button>
			<div class="lg:absolute w-full hidden lg:flex justify-center top-1">
				Usable Amount
			</div>
			<div class="flex justify-center items-center h-full lg:text-[1rem] xl:text-[3rem] 2xl:text-[5rem] py-5 lg:pb-6 lg:pt-12">
				@ClientData.Item3
			</div>
		</div>

		<!--User Reserver-->
		<div class="order-2 lg:order-4 text-center rounded-2xl col-span-1 lg:col-span-1 bg-[#FF5722] text-white relative font-extrabold">
			<a asp-page=""
			   class="absolute top-2 left-2 fa-solid fa-pen-to-square"></a>
			<button onclick="showInfo('UserReserver')"
					class="z-10 absolute fas fa-info-circle top-2 right-2"></button>
			<div class="lg:absolute w-full hidden lg:flex justify-center top-1">
				User Reserver
			</div>
			<div class="flex justify-center items-center h-full lg:text-[1rem] xl:text-[3rem] 2xl:text-[5rem] py-5 lg:pb-6 lg:pt-12">
				@ClientData.Item4
			</div>
		</div>

		<!--System Reserver-->
		<div class="order-3 lg:order-5 text-center rounded-2xl col-span-1 lg:col-span-1 bg-[#2196F3] text-white relative font-extrabold">
			<button onclick="showInfo('SystemReserver')"
					class="z-10 absolute fas fa-info-circle top-2 right-2 text-xs sm:text-sm md:text-md lg:text-lg xl:text-xl 2xl:text-2xl"></button>
			<div class="lg:absolute w-full hidden lg:flex justify-center top-1">
				System Reserver
			</div>
			<div class="flex justify-center items-center h-full lg:text-[1rem] xl:text-[3rem] 2xl:text-[5rem] py-5 lg:pb-6 lg:pt-12">
				@ClientData.Item5
			</div>
		</div>

		<!--Monthly Usage-->
		<div class="order-6 lg:order-8 p-3 text-center h-full bg-white border border-green-500 rounded-2xl col-span-4 lg:col-span-1 relative">
			<button onclick="showInfo('MonthlyChart')"
					class="absolute fas fa-info-circle top-2 right-2"></button>
			<div class="max-w-[15rem] mx-auto h-full flex justify-center items-center">
				<canvas id="donutChart"></canvas>
			</div>
		</div>

		<!--Transaction-->
		<div class="order-7 lg:order-6 p-3 text-center bg-[#E0E0E0] text-[#424242] rounded-2xl col-span-4 lg:col-span-4 py-8 relative">
			<a asp-page="" class="text-2xl font-semibold absolute top-1 lg:top-2 left-2 fas fa-angle-double-right"></a>
			<button onclick="showInfo('Transaction')" class="absolute fas fa-info-circle top-2 right-2"></button>
			<h2 class="text-2xl font-semibold">Transaction History</h2>
			<div class="flex justify-center items-center h-full">
				<div class="flex flex-grow space-x-4 overflow-x-auto">
					@{
						int TVi = 1;
						foreach (var item in TV)
						{
							<div class="flex-grow bg-gray-50 p-4 rounded-md w-72 border border-green-500">
								<p class="text-gray-600">
									To:
									<span class="text-gray-800 font-semibold">@item.TransactionTo</span>
								</p>
								<p class="text-gray-600 pt-2">
									From:
									<span class="text-gray-800 font-semibold">@item.TransactionFrom</span>
								</p>
								<p class="text-gray-600 pt-2">
									Amount:
									<span class="text-green-500 font-semibold">@item.Amount</span>
								</p>
								<p class="text-gray-600 pt-2">
									<span class="text-gray-800 font-semibold">@item.Time</span>
								</p>
							</div>
							@if (TVi == 4)
							{
								break;
							}
							TVi++;
						}
					}
				</div>
			</div>
		</div>

		<!--Saving-->
		<div class="order-8 p-3 text-center bg-[#C8E6C9] text-[#2E7D32] rounded-2xl col-span-4 lg:col-span-2 relative">
			<button onclick="showInfo('Savings')"
					class="absolute fas fa-info-circle top-2 right-2"></button>
			<a asp-page=""
			   class="text-2xl font-semibold absolute top-1 lg:top-2 left-2 fas fa-ellipsis-h"></a>
			<button onclick="showInfo('Savings')" class="absolute fas fa-info-circle top-2 right-2"></button>
			<a asp-page="" class="text-2xl font-semibold absolute top-1 lg:top-2 left-2 fas fa-ellipsis-h"></a>
			<div class="flex justify-center items-center h-full">
				<div class="mt-4 text-white">
					<p class="text-green-600 text-sm/[17px] md:text-lg lg:text-4xl font-bold mb-2">@Sresult.Item1</p>
					<p class="text-green-600 text-sm/[17px] md:text-lg lg:text-2xl">Current Amount: @Sresult.Item2</p>
					<p class="text-green-600 text-sm/[17px] md:text-lg lg:text-2xl">Total Amount: @Sresult.Item3</p>
				</div>
				<div class="mt-4 overflow-hidden">
					<div class="block flex justify-center items-center p-8 w-full">
						<div class="relative">
							<div id="circle-bg-1" class="flex justify-center items-center w-32 h-32 rounded-full bg-gray-300">
								<span id="progress-text-1" class="font-semibold text-4xl bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-transparent bg-clip-text">0%</span>
							</div>
							<svg class="absolute top-0 left-0 transform -rotate-90 w-full h-full" viewBox="0 0 128 128">
								<circle class="text-gray-300" stroke-width="10" stroke="currentColor" fill="transparent" r="54" cx="64" cy="64"></circle>
								<circle id="progress-bar-lingering-1" stroke-width="10" stroke-dasharray="339.292" stroke-dashoffset="339.292" stroke-linecap="round" fill="transparent" r="54" cx="64" cy="64"></circle>
								<circle id="progress-bar-1" stroke-width="10" stroke-dasharray="339.292" stroke-dashoffset="339.292" stroke-linecap="round" stroke="url(#gradient)" fill="transparent" r="54" cx="64" cy="64"></circle>
								<linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
									<stop offset="0%" style="stop-color: #3B82F6;"></stop>
									<stop offset="50%" style="stop-color: #9333EA;"></stop>
									<stop offset="100%" style="stop-color: #F472B6;"></stop>
								</linearGradient>
							</svg>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!--Loan-->
		<div class="order-9 p-3 text-center bg-[#FFCDD2] text-[#C62828] rounded-2xl col-span-4 lg:col-span-2 relative">
			<button onclick="showInfo('Loans')"
					class="absolute fas fa-info-circle top-2 right-2"></button>
			<a asp-page=""
			   class="text-2xl font-semibold absolute top-1 lg:top-2 left-2 fas fa-ellipsis-h"></a>
			<button onclick="showInfo('Loans')" class="absolute fas fa-info-circle top-2 right-2"></button>
			<a asp-page="" class="text-2xl font-semibold absolute top-1 lg:top-2 left-2 fas fa-ellipsis-h"></a>
			<div class="flex justify-center items-center h-full">
				<div class="mt-4 text-white">
					<p class="text-[#7f000d] text-sm/[17px] md:text-lg lg:text-4xl font-bold mb-2">@Lresult.Item1</p>
					<p class="text-[#7f000d] text-sm/[17px] md:text-lg lg:text-2xl">Current Amount: @Lresult.Item2</p>
					<p class="text-[#7f000d] text-sm/[17px] md:text-lg lg:text-2xl">Total Amount: @Lresult.Item3</p>
				</div>
				<div class="mt-4 overflow-hidden">
					<div class="flex justify-center items-center p-8 w-full">
						<div class="relative">
							<div id="circle-bg-2" class="flex justify-center items-center w-32 h-32 rounded-full bg-gray-300">
								<span id="progress-text-2" class="font-semibold text-4xl bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-transparent bg-clip-text">0%</span>
							</div>
							<svg class="absolute top-0 left-0 transform -rotate-90 w-full h-full" viewBox="0 0 128 128">
								<circle class="text-gray-300" stroke-width="10" stroke="currentColor" fill="transparent" r="54" cx="64" cy="64"></circle>
								<circle id="progress-bar-lingering-2" stroke-width="10" stroke-dasharray="339.292" stroke-dashoffset="339.292" stroke-linecap="round" fill="transparent" r="54" cx="64" cy="64"></circle>
								<circle id="progress-bar-2" stroke-width="10" stroke-dasharray="339.292" stroke-dashoffset="339.292" stroke-linecap="round" stroke="url(#gradient)" fill="transparent" r="54" cx="64" cy="64"></circle>
							</svg>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!--Subscription-->
		<div class="order-10 p-3 lg:p-2 text-center bg-[#BBDEFB] text-[#1565C0] rounded-2xl col-span-4 lg:col-span-5 relative">
			<button onclick="showInfo('Subscriptions')" class="absolute fas fa-info-circle top-2 right-2"></button>
			<a asp-page="" class="text-2xl font-semibold absolute top-1 lg:top-2 left-2 fas fa-ellipsis-h"></a>
			<div class="pt-5 flex justify-center items-center h-full">
				<div class="flex flex-grow overflow-x-auto mx-auto space-x-4">
					@{
						int SVi = 1;
						foreach (var v in SV)
						{
							if (SVi == 5)
							{
								break;
							}
							for (int i = 0; i < 4; i++)
							{
								<div class="flex-grow bg-white p-6 rounded-md shadow-md">
									<h2 class="font-semibold mb-4">@v.Name</h2>
									<p class="text-gray-600">@v.Amount DKK</p>
									<button onclick="cancelSubscription('@v.Name')" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-md">
										Manage
									</button>
								</div>
							}
							SVi++;
						}
					}
				</div>
			</div>
		</div>

	</div>
</body>

<script src="/js/sweetalert.js"></script>
<script src="/js/SweetInfo.js"></script>
<script src="/js/MonthlyUsage.js"></script>
<script>
	var labels = @Html.Raw(Json.Serialize(CSLabel));
	var data = @Html.Raw(Json.Serialize(CSdata));
	var backgroundColors = @Html.Raw(Json.Serialize(CSbackgroundColor));
	initializeProgressBars(labels, data, backgroundColors)
</script>
<script src="/js/ProgressBar.js"></script>
<script>
	var progressBars = @Html.Raw(Json.Serialize(progressBars));
	var firstProgressBar = progressBars[0];
	var secondProgressBar = progressBars[1];

	updateProgress('progress-bar-1', 'progress-bar-lingering-1', 'progress-text-1', firstProgressBar);
	updateProgress('progress-bar-2', 'progress-bar-lingering-2', 'progress-text-2', secondProgressBar);
</script>

